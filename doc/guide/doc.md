# ドキュメント戦略

## 基本方針

### 最優先目標

<primary-goal>
AI（LLM）が各ワークフローを実行する際に、必要な情報を明確に特定し、適切な順序で参照して、最小限で完全な実装を実現できること
</primary-goal>

**具体的な成功基準**:
- AI が迷わずに次のアクションを決定できる
- 必要な情報が3ステップ以内で到達可能
- コンテキスト不足による実装エラーが発生しない
- **過剰実装を避け、要求仕様に対する最小限の実装を完成できる**
- **ユーザーフィードバックに基づく即座の軌道修正が可能**

### 副次目標

- 人間が読みやすく理解しやすいドキュメント
- メンテナンスコストの最小化（情報の重複を避け、変更時の更新箇所を最小化）
- 実装との乖離防止（コードファーストの文書化戦略）

## 設計原則

### SSOT（Single Source of Truth）

**原則**: 各情報は唯一の権威ある場所に記録し、他の場所では参照のみを行う

**実装方法**:
- 情報の重複を避け、単一の信頼できる情報源を維持
- 相互参照には明確なパス表記を使用（例: `doc/guide/architecture.md:Section2`）
- **例外**: AI ツール専用ファイル（`CLAUDE.md`、`.cursor/rules/*.mdc`、`.gemini/styleguide.md`）
  - 理由: ツール固有の指示形式や制約により、一般文書との統合が困難

### 階層化戦略

<document-hierarchy>
```
1. README.md         # エントリーポイント - 人間が最初に読む概要と環境構築手順
2. AIツール必須参照     # CLAUDE.md 等（全ワークフロー共通の概要とAIツール特有の動作指示）
3. プロセス定義        # doc/workflow/*.yaml（構造化された手順定義、バリデーション条件付き）
4. ワークフロー参照     # doc/guide/*.md（実行時の詳細参照情報、AI読み取り最適化済み）
5. 成果物保存         # doc/requirement/*.md（時系列で管理される要件・タスク履歴）
```
</document-hierarchy>

**階層化の理由**:
- **認知負荷の分散**: 各レベルで必要な情報の粒度を調整
- **プログレッシブ・ディスクロージャー**: 概要から詳細へと段階的に情報を提供
- **AI の効率的な情報取得**: 必要最小限の読み込みで適切な判断を可能にする

### 仕様管理方針

**コードファースト戦略**:
- **仕様書は作成しない** - メンテナンスコストと乖離リスクを避ける
- **コード内ドキュメンテーション重視** - dartdoc コメントで API 仕様を記述
- **構造ガイドで誘導** - `architecture.md`、`features.md` で実装の参照先を明示

**品質保証メカニズム**:
- 実装変更時の関連ドキュメント更新をワークフローに組み込み
- AI による整合性チェックを定期実行

## ディレクトリ別役割

### doc/guide/

**目的**: ワークフロー実行時の参照情報
**対象読者**: AI・人間共通
**内容**:

- `architecture.md` - アーキテクチャガイド
- `features.md` - 機能一覧・ディレクトリ構成
- `test.md` - テスト戦略
- `doc.md` - このドキュメント戦略

**品質基準**:

- 過不足なく参照できるよう細分化
- 端的で明確な記述
- AI が効率的に読み取れる構造
- **最小限の実装指針を明示（過剰実装回避）**
- **ユーザー要求との差分に基づく即座の修正指針**

### doc/workflow/

**目的**: AI ワークフローのプロセス定義
**対象読者**: AI（主）・人間（副）
**内容**:

- `requirements.yaml` - 要件定義
- `tasks.yaml` - タスクシート作成
- `implement.yaml` - 実装
- `review.yaml` - コードレビュー

**品質基準**:

- 構造化された YAML 形式
- 各段階の入力・出力を明確化
- バリデーション条件を含む

### doc/requirement/

機能開発の要件定義書とタスクシートを時系列管理。詳細は architecture.md 参照。

## AI実装効率化のための指針

### 最小限実装の原則

**過剰実装回避戦略**:
- タスクシートの要求仕様を厳密に守る
- ユーザーが明示的に要求していない機能は実装しない
- サンプルコード・例示ファイルは必要最小限に留める
- ドキュメンテーションコメントはプロジェクト言語（日本語）で統一

**ユーザーフィードバック活用**:
- 実装中のユーザー指摘は即座に反映
- 「不要」「変更」指示は最優先で対応
- 仕様理解の不一致は実装前に確認
- 完成後の修正よりも途中での軌道修正を重視

### 効率的な実装フロー

**実装順序の最適化**:
1. タスクシート要求の厳密な理解
2. 最小限の実装完了
3. ユーザー確認・フィードバック反映
4. 品質保証・テスト実行
5. 最終調整・コミット

**コミュニケーション最適化**:
- 実装方針の事前確認で手戻り防止
- ユーザー指摘への即座対応
- 完成品提示前の中間確認推奨
